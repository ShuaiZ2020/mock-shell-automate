# 附录


```{r, include=FALSE}
knitr::opts_chunk$set(echo = F,warning = F, message = F)
output_format <- knitr::opts_knit$get("rmarkdown.pandoc.to")
source(paste0(Sys.getenv("USERPROFILE"),"/OneDrive/Work Yeedo/Other/Code/table_format.R"), local = knitr::knit_global())
```
```{r}
source("../Code/book_script.R", local = knitr::knit_global())
```
```{r}

source("../Code/shell-table-function.R", local = knitr::knit_global())
```

::: {custom-style="SHELL-16-01-节标题2"}
受试者数据列表
:::

::: {custom-style="SHELL-16-01-节标题3"}
研究受试者
:::

```{r}
formoid <- "入组受试者分布"
population <- "筛选集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
ds4 <- make_mock_shell(formoid = "DS4", 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_pre = c("受试者筛选号" ),
                col_combine = c()
                )

ds6 <- make_mock_shell(formoid = "DS6", 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_pre = c()
                )
table <- cbind(ds4$table, ds6$table)%>%format_table()

footnote <- ds6$footnote
```
`r title`
`r table`
`r footnote`

```{r}
formoid <- "筛选失败受试者"
population <- "筛选集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = "DS2", 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_pre = c("受试者筛选号", "知情同意书签署日期"),
                col_combine = c(),
                col_remove = c("受试者是否筛选成功？"),
                no_empty = F
                )

table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```
`r title`
`r table`
`r footnote`


::: {custom-style="SHELL-16-01-节标题3"}
分析集汇总
:::

```{r}
formoid <- "受试者所属分析集"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)

```
`r title`



::: {custom-style="SHELL-16-01-节标题3"}
人口统计学和其他基线特征 
:::

```{r}
formoid <- "DM"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
dm <- make_mock_shell(formoid = "DM", 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c("年龄", "性别"),
                
                )

hw1 <- make_mock_shell(formoid = "HW1", 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_pre = c()
                )
table <- cbind(dm$table, hw1$table)%>%format_table()

footnote <- hw1$footnote
```

`r title`
`r table`
`r footnote`


```{r}
formoid = "MH2"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = F,
                seed = "123",
                ismedDrug = T,
                col_remove = c("是否有任何其他病史？"),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote

```

`r title`
`r table`
`r footnote`

```{r}
formoid = "QRS2"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c("是否有任何其他病史？"),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`


```{r}
formoid = "TU1"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```
`r title`
`r table`
`r footnote`




```{r}
formoid = "LB10"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                col_fold = c("甲肝抗体", "HBV-DNA")
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`



```{r}
formoid <- "LB16"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`


::: {custom-style="SHELL-16-01-节标题3"}
依从性
:::

```{r}
formoid <- "EX"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = T
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`



```{r}
formoid <- "CM1"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                iswhodrug = T,
                only_yes = T
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`



```{r}
formoid <- "PR1"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                ismedDrug = T,
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = T
                )

table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`


::: {custom-style="SHELL-16-01-节标题3"}
受试者疗效以及其他非安全性数据
:::

```{r}
formoid <- "QRS5"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = T
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`



```{r}
formoid <- "QRS6"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F
                )

table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`



```{r}
formoid <- "DD"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F
                )

table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`


```{r}
formoid <- "QRS3"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F
                )

table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`


```{r}
formoid <- "QRS4"
population <- "全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F
                )

table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`


::: {custom-style="SHELL-16-01-节标题3"}
不良事件列表
:::

```{r}
formoid <- "AE"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                ismedDrug = T,
                only_yes = T,
                no_empty = F
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```


`r title`
`r table`
`r footnote`



::: {custom-style="SHELL-16-01-节标题3"}
实验室指标及其他安全相关观察指标列表
:::

```{r}
formoid <- "LB1"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c("受试者是否发生任何不良事件？"),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c("红细胞计数(RBC)", "嗜碱性粒细胞计数（BASO）")
                )

table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote

```

`r title`
`r table`
`r footnote`



```{r}
formoid <- "LB3"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c("谷丙转氨酶(ALT)", "镁")
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote

```

`r title`
`r table`
`r footnote`


```{r}
formoid <- "LB4"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c("凝血酶原时间", "国际标准化比值")
                )

table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote

```

`r title`
`r table`
`r footnote`



```{r}
formoid <- "LB5"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c("心肌蛋白", "ProBNP")
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`
```{r}
formoid <- "LB6"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c("CRP", "CRP")
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`
```{r}
formoid <- "LB7"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "127",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c(),
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`
```{r}
formoid <- "LB8"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c("ST2", "TNF-α")
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`

```{r}
formoid <- "LB9"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "127",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`

```{r}
formoid <- "LB10"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "127",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c("甲肝抗体", "HBV-DNA")
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`


```{r}
formoid <- "LB11"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "127",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c("CMV-DNA", "CMV抗体")
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`

```{r}
formoid <- "LB12"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "127",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c("EBV-DNA", "EBV抗体")
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`

```{r}
formoid <- "LB13"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "127",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`

```{r}
formoid <- "LB14"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "127",
                col_remove = c(),
                col_pre = c(),
                col_combine = c(),
                only_yes = F,
                col_fold = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`

```{r}
formoid <- "LB15"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`

```{r}
formoid <- "LB16"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表续'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c("T-SPOT","T-SPOT")
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`


```{r}
formoid <- "PE"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`

```{r}
formoid <- "QRS1"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`

```{r}
formoid <- "TU2"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`

```{r}
formoid <- "TU3"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`

```{r}
formoid <- "VS1"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`

```{r}
formoid <- "VS2"
population <- "安全数据集"
word_style <- 'SHELL-16-01-列表'
title <- add_title(formoid, population, word_style)
mock_shell <- make_mock_shell(formoid = formoid, 
                row_num = 4, 
                replace_string = T,
                seed = "123",
                col_remove = c(),
                col_pre = c("受试者随机号", "随机组别"),
                col_combine = c(),
                only_yes = F,
                col_fold = c()
                )
table <- mock_shell$table%>%format_table()
footnote <- mock_shell$footnote
```

`r title`
`r table`
`r footnote`

